<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag & Drop Module Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .function-list {
            background: #e9ecef;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .function-item {
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 3px;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-available {
            background: #28a745;
        }
        .status-missing {
            background: #dc3545;
        }
        .module-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .drag-drop-demo {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .demo-item {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #dee2e6;
            border-radius: 4px;
            cursor: grab;
        }
        .demo-item:active {
            cursor: grabbing;
        }
        .demo-dropzone {
            background: #e9ecef;
            padding: 20px;
            margin: 10px 0;
            border: 2px dashed #6c757d;
            border-radius: 4px;
            min-height: 100px;
            text-align: center;
        }
        .demo-dropzone.dragover {
            background: #d4edda;
            border-color: #28a745;
        }
    </style>
</head>
<body>
    <h1>üß™ Drag & Drop Module Test</h1>
    
    <div class="module-info">
        <h3>üìã Module Information</h3>
        <p><strong>Module:</strong> Drag & Drop Module</p>
        <p><strong>Location:</strong> <code>src/renderer/modules/drag-drop/</code></p>
        <p><strong>Purpose:</strong> Handles all drag and drop functionality for moving songs between containers and rearranging UI elements</p>
        <p><strong>Status:</strong> <span id="module-status">Testing...</span></p>
    </div>

    <div class="test-section">
        <h3>üîç Module Detection Test</h3>
        <button class="test-button" onclick="testModuleDetection()">Test Module Detection</button>
        <div id="detection-results"></div>
    </div>

    <div class="test-section">
        <h3>üìã Function Availability Test</h3>
        <button class="test-button" onclick="testFunctionAvailability()">Test Function Availability</button>
        <div id="function-results"></div>
    </div>

    <div class="test-section">
        <h3>üîß Function Testing</h3>
        <button class="test-button" onclick="testHotkeyDrop()">Test hotkeyDrop()</button>
        <button class="test-button" onclick="testHoldingTankDrop()">Test holdingTankDrop()</button>
        <button class="test-button" onclick="testAllowHotkeyDrop()">Test allowHotkeyDrop()</button>
        <button class="test-button" onclick="testSongDrag()">Test songDrag()</button>
        <button class="test-button" onclick="testColumnDrag()">Test columnDrag()</button>
        <div id="function-test-results"></div>
    </div>

    <div class="test-section">
        <h3>üéØ Integration Test</h3>
        <button class="test-button" onclick="testModuleIntegration()">Test Module Integration</button>
        <div id="integration-results"></div>
    </div>

    <div class="test-section">
        <h3>üñ±Ô∏è Drag & Drop Demo</h3>
        <div class="drag-drop-demo">
            <h4>Demo Items (Draggable)</h4>
            <div class="demo-item" draggable="true" data-songid="demo-song-1">Demo Song 1</div>
            <div class="demo-item" draggable="true" data-songid="demo-song-2">Demo Song 2</div>
            <div class="demo-item" draggable="true" data-songid="demo-song-3">Demo Song 3</div>
            
            <h4>Demo Drop Zones</h4>
            <div class="demo-dropzone" id="demo-hotkey-zone">
                <strong>Hotkey Zone</strong><br>
                Drop songs here to assign to hotkeys
            </div>
            <div class="demo-dropzone" id="demo-holding-tank-zone">
                <strong>Holding Tank Zone</strong><br>
                Drop songs here to add to holding tank
            </div>
        </div>
    </div>

    <div class="test-section">
        <h3>üìä Test Summary</h3>
        <button class="test-button" onclick="runAllTests()">Run All Tests</button>
        <div id="summary-results"></div>
    </div>

    <script type="module">
        // Import the drag and drop module
        import dragDropModule from './renderer/modules/drag-drop/index.js';

        // Make module available globally for testing
        window.dragDropModule = dragDropModule;

        // Test functions
        window.testModuleDetection = function() {
            const results = document.getElementById('detection-results');
            results.innerHTML = '';

            try {
                if (window.dragDropModule) {
                    results.innerHTML += '<div class="result success">‚úÖ Drag & Drop Module detected successfully</div>';
                    results.innerHTML += '<div class="result info">Module object: ' + typeof window.dragDropModule + '</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå Drag & Drop Module not detected</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error detecting module: ' + error.message + '</div>';
            }
        };

        window.testFunctionAvailability = function() {
            const results = document.getElementById('function-results');
            results.innerHTML = '';

            const functions = [
                'hotkeyDrop',
                'holdingTankDrop', 
                'allowHotkeyDrop',
                'songDrag',
                'columnDrag',
                'initializeDragDrop',
                'getDragDropFunctions'
            ];

            let availableCount = 0;
            let totalCount = functions.length;

            results.innerHTML += '<div class="function-list">';
            functions.forEach(funcName => {
                const isAvailable = typeof window.dragDropModule[funcName] === 'function';
                const statusClass = isAvailable ? 'status-available' : 'status-missing';
                const statusText = isAvailable ? 'Available' : 'Missing';
                
                results.innerHTML += `
                    <div class="function-item">
                        <span class="status-indicator ${statusClass}"></span>
                        <strong>${funcName}():</strong> ${statusText}
                    </div>
                `;
                
                if (isAvailable) availableCount++;
            });
            results.innerHTML += '</div>';

            results.innerHTML += `<div class="result ${availableCount === totalCount ? 'success' : 'error'}">
                ${availableCount}/${totalCount} functions available
            </div>`;
        };

        window.testHotkeyDrop = function() {
            const results = document.getElementById('function-test-results');
            results.innerHTML = '';

            try {
                if (typeof window.dragDropModule.hotkeyDrop === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ hotkeyDrop function is available</div>';
                    results.innerHTML += '<div class="result info">Function signature: hotkeyDrop(event)</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå hotkeyDrop function is not available</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing hotkeyDrop: ' + error.message + '</div>';
            }
        };

        window.testHoldingTankDrop = function() {
            const results = document.getElementById('function-test-results');
            results.innerHTML = '';

            try {
                if (typeof window.dragDropModule.holdingTankDrop === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ holdingTankDrop function is available</div>';
                    results.innerHTML += '<div class="result info">Function signature: holdingTankDrop(event)</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå holdingTankDrop function is not available</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing holdingTankDrop: ' + error.message + '</div>';
            }
        };

        window.testAllowHotkeyDrop = function() {
            const results = document.getElementById('function-test-results');
            results.innerHTML = '';

            try {
                if (typeof window.dragDropModule.allowHotkeyDrop === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ allowHotkeyDrop function is available</div>';
                    results.innerHTML += '<div class="result info">Function signature: allowHotkeyDrop(event)</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå allowHotkeyDrop function is not available</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing allowHotkeyDrop: ' + error.message + '</div>';
            }
        };

        window.testSongDrag = function() {
            const results = document.getElementById('function-test-results');
            results.innerHTML = '';

            try {
                if (typeof window.dragDropModule.songDrag === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ songDrag function is available</div>';
                    results.innerHTML += '<div class="result info">Function signature: songDrag(event)</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå songDrag function is not available</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing songDrag: ' + error.message + '</div>';
            }
        };

        window.testColumnDrag = function() {
            const results = document.getElementById('function-test-results');
            results.innerHTML = '';

            try {
                if (typeof window.dragDropModule.columnDrag === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ columnDrag function is available</div>';
                    results.innerHTML += '<div class="result info">Function signature: columnDrag(event)</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå columnDrag function is not available</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing columnDrag: ' + error.message + '</div>';
            }
        };

        window.testModuleIntegration = function() {
            const results = document.getElementById('integration-results');
            results.innerHTML = '';

            try {
                // Test initialization
                if (typeof window.dragDropModule.initializeDragDrop === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ initializeDragDrop function is available</div>';
                } else {
                    results.innerHTML += '<div class="result error">‚ùå initializeDragDrop function is not available</div>';
                }

                // Test getDragDropFunctions
                if (typeof window.dragDropModule.getDragDropFunctions === 'function') {
                    results.innerHTML += '<div class="result success">‚úÖ getDragDropFunctions function is available</div>';
                    
                    const functions = window.dragDropModule.getDragDropFunctions();
                    if (functions && typeof functions === 'object') {
                        results.innerHTML += '<div class="result success">‚úÖ getDragDropFunctions returns valid object</div>';
                        results.innerHTML += '<div class="result info">Available functions: ' + Object.keys(functions).join(', ') + '</div>';
                    } else {
                        results.innerHTML += '<div class="result error">‚ùå getDragDropFunctions does not return valid object</div>';
                    }
                } else {
                    results.innerHTML += '<div class="result error">‚ùå getDragDropFunctions function is not available</div>';
                }

            } catch (error) {
                results.innerHTML += '<div class="result error">‚ùå Error testing module integration: ' + error.message + '</div>';
            }
        };

        window.runAllTests = function() {
            const results = document.getElementById('summary-results');
            results.innerHTML = '';

            // Run all tests
            testModuleDetection();
            setTimeout(() => {
                testFunctionAvailability();
                setTimeout(() => {
                    testModuleIntegration();
                    setTimeout(() => {
                        // Summary
                        results.innerHTML += '<div class="result info">üéØ All tests completed. Check individual test results above.</div>';
                        results.innerHTML += '<div class="result success">‚úÖ Drag & Drop Module extraction appears successful!</div>';
                    }, 100);
                }, 100);
            }, 100);
        };

        // Setup demo drag and drop functionality
        function setupDemoDragDrop() {
            // Demo song drag
            document.querySelectorAll('.demo-item').forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text', this.getAttribute('data-songid'));
                    console.log('Demo drag started for:', this.getAttribute('data-songid'));
                });
            });

            // Demo drop zones
            document.querySelectorAll('.demo-dropzone').forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });

                zone.addEventListener('dragleave', function(e) {
                    this.classList.remove('dragover');
                });

                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    const songId = e.dataTransfer.getData('text');
                    console.log('Demo drop:', songId, 'into', this.id);
                    this.innerHTML += `<div class="demo-item">Dropped: ${songId}</div>`;
                });
            });
        }

        // Auto-run module detection on load
        window.addEventListener('load', function() {
            document.getElementById('module-status').textContent = 'Ready for testing';
            testModuleDetection();
            setupDemoDragDrop();
        });
    </script>
</body>
</html> 